---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import type { GetStaticPaths } from "astro";
import type { CollectionEntry } from "astro:content";

// Component Imports
import ProgramIntro from "../../components/ProgramSlug/ProgramIntro.astro";
import ContentCTA from "../../components/ProgramSlug/ContentCTA.astro";
import WhatIsIncluded from "../../components/ProgramSlug/WhatIsIncluded.astro";
import WhyUs from "../../components/ProgramSlug/WhyUs.astro";
import TimelineProgression from "../../components/ProgramSlug/TimelineProgression.astro";
import FAQ from "../../components/ProgramSlug/FAQ.astro";
import FinalCTA from "../../components/ProgramSlug/FinalCTA.astro";
import Hero75 from "../../components/Hero75.astro";
import CTAMeetOurFleet from "../../components/CTAMeetOurFleet.astro";
import CTAEnrollWithUsBlue from "../../components/CTAEnrollWithUsBlue.astro";
import { AIRPORT, AIRPORT_CODE, COMPANY_NAME, COMPANY_NICKNAME, LOCATION } from "../../data/consts";
// Static Path Generation
export const getStaticPaths = (async () => {
  const programs = await getCollection("programs");
  return programs.map((program) => ({
    params: { slug: program.slug },
    props: { program },
  }));
}) satisfies GetStaticPaths;

// Props
type Props = {
  program: CollectionEntry<"programs">;
};

const { program } = Astro.props;
const { data } = program;

const heroData = {
  image: {
    src: program.data.image,
    alt: program.data.alt || program.data.title,
    reverse: program.data.reverse || false,
    top: program.data.top || false,
  },
  title: program.data.title,
  subTitle: program.data.description,
  cta: [
    {
      url: "/enrollment",
      text: "Enroll Now",
    },
  ],
};

const metaTagsData = {
  siteTitle: `${data.title} in ${LOCATION.city}, ${LOCATION.state} | ${COMPANY_NAME}`,
  siteDescription: `${data.description} at ${COMPANY_NICKNAME}, located at ${AIRPORT} (${AIRPORT_CODE}). Our ${data.title} program offers professional flight training in ${LOCATION.locationFull} for aspiring pilots.`,
  siteKeywords: [
    `${data.title} ${LOCATION.city}`,
    `${data.title} ${LOCATION.state}`,
    `${data.title} ${AIRPORT_CODE}`,
    `${COMPANY_NAME} ${data.title}`,
    `flight training ${LOCATION.locationShort}`,
    `pilot license ${LOCATION.city}`,
    `aviation courses ${LOCATION.state}`,
    `${AIRPORT} flight school`,
  ].join(", "),
};
---

<BaseLayout {...metaTagsData}>
  <main>
    <Hero75 data={heroData} />
    {
      data.programIntroduction && (
        <ProgramIntro data={data.programIntroduction} />
      )
    }
    {data.firstCTA && <ContentCTA data={data.firstCTA} />}
    {data.whatIsIncluded && <WhatIsIncluded data={data.whatIsIncluded} />}
    {data.whyUs && <WhyUs data={data.whyUs} />}
    {
      data.trainingProgression && (
        <TimelineProgression data={data.trainingProgression} />
      )
    }
    {
      data.finalCTA && (
        <FinalCTA
          data={{ ...data.finalCTA, imagePosition: "object-[50%_50%]" }}
        />
      )
    }
    {data.faq && <FAQ data={data.faq} />}
    <CTAEnrollWithUsBlue
      upperHeadingTextSize="!text-xl"
      titleTextSize="!text-3xl"
      paragraphTextSize="!text-md"
      showButton={true}
    />
    <CTAMeetOurFleet imageSide="left" background="red" />
  </main>
</BaseLayout>
