---
import BaseLayout from "../../layouts/BaseLayout.astro";
import HeroScreen from "../../components/HeroScreen2.astro";
import { getCollection } from "astro:content";
import BlogPostCard from "../../components/BlogPostCard.astro";
import CTASection from "../../components/CTASection.astro";
import CTAEnrollWithUsMini from "../../components/CTAEnrollWithUsMini.astro";
import CTAEnrollWithUs from "../../components/CTAEnrollWithUs.astro";
import Hero75 from "../../components/Hero75.astro";

const blogPosts = await getCollection("blog");
const sortedPosts = blogPosts.sort(
  (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime()
);

// Separar o primeiro post (featured) dos demais
const featuredPost = sortedPosts[0];
const remainingPosts = sortedPosts.slice(1);

// Format date helper
const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  }).format(date);
};

const heroData = {
  image: { src: "/src/assets/old website/background.jpg", alt: "Background" },
  upperHeader: "Latest Insights",
  title: "Stay Informed <br> About Aviation and Flight Training",
  subTitle:
    "Explore articles, tips, and updates from Eagle Aircraft Flight Academy. Learn from our instructors, discover industry news, and enhance your pilot knowledge.",
  cta: [
    { url: "/discovery-flight", text: "Book a Discovery Flight"  },
    { url: "/crew", text: "Meet the Team" },
  ],
};

const constBlogData = {
  upperHeader: "Eagle Air's",
  title: "Blog",
  paragraphs: [
    "Stay informed with the latest aviation insights, training tips, relevant informations, and industry news.",
  ],
  upperHeaderTwo: "They Are Here For You",
  titleTwo: "Our Fleet Aircrafts"
};
---

<BaseLayout
  siteTitle="Blog | Eagle Aircraft Aviation Academy"
  siteDescription="Aviation insights, training tips, and industry news"
>
  <Hero75 data={heroData} />

  <CTAEnrollWithUsMini></CTAEnrollWithUsMini>
  
  <section class="py-16 px-4 bg-muted-50">
    <div class="max-w-7xl mx-auto">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        
        {featuredPost && (
          <div class="md:col-span-2 lg:col-span-3">
            <div class="relative">
              <span class="absolute top-4 left-4 bg-monza-700 text-white px-4 py-1 text-sm font-bold uppercase z-10">
                Featured
              </span>
              <BlogPostCard isHighlight={true} post={featuredPost} featured={true}></BlogPostCard>
            </div>
          </div>
        )}
        
        {remainingPosts.map((post) => (
          <BlogPostCard post={post}></BlogPostCard>
        ))}
        
      </div>
    </div>
  </section>
  
  <CTAEnrollWithUs
    upperHeadingTextSize="!text-xl"
    titleTextSize="!text-3xl"
    showButton={true} 
  />
  <CTASection />
</BaseLayout>