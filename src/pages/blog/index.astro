---
import BaseLayout from "../../layouts/BaseLayout.astro";
import HeroScreen from "../../components/HeroScreen2.astro";
import { getCollection } from "astro:content";
import BlogPostCard from "../../components/BlogPostCard.astro";
import CTASection from "../../components/CTASection.astro";
import CTAEnrollWithUsMini from "../../components/CTAEnrollWithUsMini.astro";
import CTAEnrollWithUs from "../../components/CTAEnrollWithUs.astro";
import Hero75 from "../../components/Hero75.astro";
import { AIRPORT, AIRPORT_CODE, COMPANY_NAME, COMPANY_NICKNAME, LOCATION } from "../../data/consts";

const blogPosts = await getCollection("blog");
const sortedPosts = blogPosts.sort(
  (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime()
);

// Separar o primeiro post (featured) dos demais
const featuredPost = sortedPosts[0];
const remainingPosts = sortedPosts.slice(1);

// Format date helper
const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  }).format(date);
};

const heroData = {
  image: { src: "/src/assets/old website/background.jpg", alt: "Background" },
  upperHeader: "Latest Insights",
  title: "Stay Informed <br> About Aviation and Flight Training",
  subTitle:
    "Explore articles, tips, and updates from Eagle Aircraft Flight Academy. Learn from our instructors, discover industry news, and enhance your pilot knowledge.",
  cta: [
    { url: "/discovery-flight", text: "Book a Discovery Flight" },
    { url: "/crew", text: "Meet the Team" },
  ],
};

const constBlogData = {
  upperHeader: "Eagle Aircraft's",
  title: "Blog",
  paragraphs: [
    "Stay informed with the latest aviation insights, training tips, relevant informations, and industry news.",
  ],
  upperHeaderTwo: "They Are Here For You",
  titleTwo: "Our Fleet Aircrafts",
};

const metaTagsData = {
  siteTitle: `Aviation News & Flight Training Tips | ${COMPANY_NAME} Blog`,
  siteDescription: `Stay updated with the latest aviation insights, flight training tips, and news from ${COMPANY_NICKNAME}. Read about pilot life at ${AIRPORT} (${AIRPORT_CODE}), career advice, and training updates in ${LOCATION.locationFull}.`,
  siteKeywords: [
    "aviation blog",
    "flight training tips",
    "pilot news Indiana",
    `learning to fly in ${LOCATION.city}`,
    `${COMPANY_NAME} updates`,
    `${COMPANY_NICKNAME} blog`,
    `${AIRPORT} news`,
    `${AIRPORT_CODE} aviation articles`,
    "how to become a pilot blog",
    "commercial pilot career advice",
    "private pilot training insights",
    "Cessna Pilot Center news",
    "FAA Part 141 training updates",
    "instrument rating tips",
    "flight instructor stories",
    "aviation lifestyle blog",
    "airline pilot pathway news",
    "student pilot resources",
    `aviation community ${LOCATION.state}`,
    "veteran flight training stories",
    "international flight student blog",
    "Liberty University aviation news",
    "Valparaiso University flight training updates",
    "aircraft maintenance tips",
    "aviation safety blog",
    "Discovery Flight stories",
    "Northwest Indiana aviation news",
    "Chicagoland flight school blog",
    "career pilot transition tips",
    "Elite simulator training benefits"
  ].join(", "),
};
---

<BaseLayout
  siteTitle={`Aviation Blog | ${COMPANY_NAME}`}
  siteDescription={`Aviation insights, pilot career advice, and flight training tips from ${COMPANY_NAME}.`}
>
  <Hero75 data={heroData} />

  <CTAEnrollWithUsMini />

  <section class="py-16 px-4 bg-muted-50">
    <div class="max-w-7xl mx-auto">
      <div class="flex flex-col gap-6 lg:gap-12">
        {
          featuredPost && (
            <div class="">
              <div class="relative">
                <span class="absolute top-4 left-4 bg-monza-700 text-white px-4 py-1 text-sm font-bold uppercase z-10">
                  Featured
                </span>
                <BlogPostCard
                  isHighlight={true}
                  post={featuredPost}
                  featured={true}
                />
              </div>
            </div>
          )
        }
        <div class="flex flex-wrap gap-y-6 gap-x-4 justify-between">
          {
            remainingPosts.map((post) => (
              <div class="w-full md:w-1/2 lg:w-[30%]">
                <BlogPostCard post={post} />
              </div>
            ))
          }
        </div>
      </div>
    </div>
  </section>

  <CTAEnrollWithUs
    upperHeadingTextSize="!text-xl"
    titleTextSize="!text-3xl"
    showButton={true}
  />
  <CTASection />
</BaseLayout>
