---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import type { GetStaticPaths } from "astro";
import type { CollectionEntry } from "astro:content";
import HeroScreen from "../../components/HeroScreen2.astro";
import ImageWithZoomEffect from "../../components/ImageWithZoomEffect.astro";
import FleetSlider from "../../components/FleetSlider.astro";
import Hero75 from "../../components/Hero75.astro";
import { AIRPORT, AIRPORT_CODE, COMPANY_NAME, COMPANY_NICKNAME, LOCATION } from "../../data/consts";

export const getStaticPaths = (async () => {
  const aircraft = await getCollection("aircraft");
  return aircraft.map((plane: CollectionEntry<"aircraft">) => ({
    params: { slug: plane.slug },
    props: { plane },
  }));
}) satisfies GetStaticPaths;

type Props = {
  plane: CollectionEntry<"aircraft">;
};

const { plane } = Astro.props as Props;
const { Content } = await plane.render();

const galleryImages =
  plane.data.gallery?.map((item) => ({
    src: item.image,
    alt: item.alt,
  })) || [];

const heroData = {
  image: {
    src: "/src/assets/angry-_-kat-5R4fBlHEegc-unsplash.jpg",
    alt: "Military aircraft in flight",
  },
  upperHeader: `Flying is Freedom`,
  title: "From First Flight <br> to Certified Pilot <br> All in One Academy",
  subTitle:
    "Accelerated FAA Part 141 pilot training designed for future commercial and airline pilots",
  cta: [{ url: "#", text: "Private Pilot (PPL)" }],
};

const metaTagsData = {
  siteTitle: `${plane.data.name} in ${LOCATION.locationFull} | ${COMPANY_NAME}`,
  siteDescription: `${plane.data.description} Train in our ${plane.data.name} at ${AIRPORT} (${AIRPORT_CODE}). ${COMPANY_NICKNAME} offers professional flight training in ${LOCATION.city}, ${LOCATION.state} for students and career pilots.`,
  siteKeywords: [
    plane.data.name,
    `${plane.data.name} flight training`,
    `${plane.data.name} rental ${LOCATION.city}`,
    `${plane.data.name} specifications`,
    `${plane.data.name} cockpit`,
    `${COMPANY_NAME} fleet`,
    `${COMPANY_NICKNAME} aircraft`,
    `fly a ${plane.data.name} in ${LOCATION.state}`,
    `flight school fleet ${LOCATION.locationFull}`,
    AIRPORT,
    AIRPORT_CODE,
    `pilot training ${LOCATION.city}`,
    `learn to fly ${LOCATION.locationShort}`,
    "Cessna Pilot Center Indiana",
    "training aircraft Valparaiso",
    "aviation fleet Northwest Indiana",
    "single engine aircraft training",
    "flight school KVPZ",
    "rent a plane in Valparaiso Indiana",
    "Porter County Regional Airport aircraft",
    "FAA approved training fleet",
    "well-maintained training planes",
    "glass cockpit flight training",
    "modern aviation fleet",
    "career pilot aircraft",
    "private pilot training aircraft",
    "instrument rating fleet",
    "commercial pilot license planes"
  ].join(", "),
};
---

<BaseLayout {...metaTagsData}>
  <Hero75 minHeight="min-h-[70vh]" data={heroData} />

  <section class="bg-muted-50">
    <div class="max-w-7xl mx-auto px-4 lg:px-8 space-y-8">
      {
        plane.data.features && plane.data.features.length > 0 && (
          <FleetSlider
            plane={plane}
            slideImageSoloAlt={plane.data.imageAlt}
            slideImageSolo={plane.data.image}
            slideImages={galleryImages}
          />
        )
      }
      {
        plane.data.specifications && (
          <div class="px-16 rounded-lg">
            <h2 class="text-2xl font-bold mb-6 font-title text-madison-950">
              Specifications
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              {plane.data.specifications.engines && (
                <div class="bg-madison-900 p-4 rounded">
                  <div class="text-sm text-muted-50 mb-1">Engine</div>
                  <div class="text-md font-semibold text-muted-50">
                    {plane.data.specifications.engines}
                  </div>
                </div>
              )}
              {plane.data.specifications.seats && (
                <div class="bg-madison-900 p-4 rounded">
                  <div class="text-sm text-muted-50 mb-1">Seating</div>
                  <div class="text-md font-semibold text-muted-50">
                    {plane.data.specifications.seats} seats
                  </div>
                </div>
              )}
              {plane.data.specifications.range && (
                <div class="bg-madison-900 p-4 rounded">
                  <div class="text-sm text-muted-50 mb-1">Range</div>
                  <div class="text-md font-semibold text-muted-50">
                    {plane.data.specifications.range}
                  </div>
                </div>
              )}
              {plane.data.specifications.cruiseSpeed && (
                <div class="bg-madison-900 p-4 rounded">
                  <div class="text-sm text-muted-50 mb-1">Cruise Speed</div>
                  <div class="text-md font-semibold text-muted-50">
                    {plane.data.specifications.cruiseSpeed}
                  </div>
                </div>
              )}
            </div>
            <div class="py-8">
              <a
                href="/aircraft"
                class="bg-monza-800 text-base text-white sm:text-lg md:text-xl px-8 py-4 text-center font-semibold transition-all duration-300 hover:scale-105 hover:shadow-2xl ml-auto block w-fit"
              >
                Back to Fleet
              </a>
            </div>
          </div>
        )
      }
    </div>
  </section>
</BaseLayout>
